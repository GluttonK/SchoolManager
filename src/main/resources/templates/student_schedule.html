<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Home</title>

    <!-- Favicon -->
    <link rel="shortcut icon" href="assets/media/image/favicon.png"/>

    <!-- Plugin styles -->
    <link rel="stylesheet" href="vendors/bundle.css" type="text/css">

    <!-- Datepicker -->
    <link rel="stylesheet" href="vendors/datepicker/daterangepicker.css">

    <!-- Slick -->
    <link rel="stylesheet" href="vendors/slick/slick.css">
    <link rel="stylesheet" href="vendors/slick/slick-theme.css">

    <!-- Vmap -->
    <link rel="stylesheet" href="vendors/vmap/jqvmap.min.css">

    <!-- App styles -->
    <link rel="stylesheet" href="assets/css/app.min.css" type="text/css">

    <!-- vue ajax -->
    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/vue.min.js"></script>
    <script src="js/axios.min.js"></script>
    <script src="https://cdn.staticfile.org/axios/0.18.0/axios.min.js"></script>
</head>

<body>

<div class="navigation">
	
    <header class="navigation-header">
        <figure class="avatar avatar-state-success">
            <img src="assets/media/image/user/man_avatar3.jpg" class="rounded-circle" alt="image">
        </figure>
        <div>
            <h5>学生姓名</h5>
            <p class="text-muted">学生院系</p>
            <ul class="nav">
                <li class="nav-item">
                    <a href="profile.html" class="btn nav-link bg-info-bright" title="Profile" data-toggle="tooltip">
                        <i data-feather="user"></i>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="btn nav-link bg-success-bright" title="Settings" data-toggle="tooltip">
                        <i data-feather="settings"></i>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="login.html" class="btn nav-link bg-danger-bright" title="Logout" data-toggle="tooltip">
                        <i data-feather="log-out"></i>
                    </a>
                </li>
            </ul>
        </div>
    </header>

    <div class="navigation-menu-body">
        <ul>
            <li>
                <a href="student_index">
                    <i class="nav-link-icon" data-feather="mail"></i>
                    <span>选课中心</span>
                </a>
            </li>
            <li>
                <a href="student_schedule">
                    <i class="nav-link-icon" data-feather="check-circle"></i>
                    <span>我的课表</span>
                </a>
            </li>
        </ul>
    </div>
	
</div>

<div id="app">
    <div class="header">
		<h4>学生中心</h4>
    </div>

    <!-- begin::main-content -->
    <div class="main-content">
        <div class="container">
            <div class="page-header">
                <h4>我的课表</h4>
				
					<div>
						<div class="table-responsive">
							<table class="table table-hover mb-0">
								<thead class="thead-light">
								<tr>
                                    <th>课程id</th>
									<th>课程名</th>
									<th>授课教师</th>
									<th>学分</th>
									<th>退课</th>
								</tr>
								</thead>
								<tbody>
								<tr v-for="course in courses">
                                    <td>{{course.courseId}}</td>
									<td>{{course.courseName}}</td>
									<td>{{course.teacherName}}</td>
									<td>{{course.courseScore}}</td>
									<td>
										<button ref="btnSelect" title="just选课" class="btn nav-link bg-success-bright"
                                                @click="deleteSc(course.courseId)">
											<i aria-hidden="true" 
											>退课</i>
										</button>
									</td>
								</tr>
								</tbody>
							</table>
						</div>
					</div>

            </div>
        </div>
    </div>
</div>


<script>
	var vue = new Vue({
		el:"#app",
		data:{
			courses: {},
            course:{},

			

		},

        mounted: function () {
            this.getSelectedCourse();
        },

		methods:{
			$:function(id){
				return document.getElementById(id);
			},
			refresh:function(){
				this.$forceUpdate();
			},


            getSelectedCourse:function(){
                const formdata=new FormData();
                formdata.append("student_id",this.student_id);
                axios
                    .post('http://localhost:8080/student_schedule/getSelectedCourse',formdata)
                    .then(response =>{
                        this.courses=response.data.courses;
                    })
                    .catch(function (error) { // 请求失败处理
                        console.log(error);
                    });
            },

			deleteSc:function(id){
				const formdata=new FormData();
				formdata.append("course_id",id);
				axios
						.post('http://localhost:8080/student_schedule/delete',formdata)
						.then(response =>{
							//this.$refs.btnSelect.click();
							alert("退课成功！");
							this.getSelectedCourse();
						})
						.catch(function (error) { // 请求失败处理
							console.log(error);
						});
			
			},



        }
	})
</script>




<!-- Plugin scripts -->
<script src="vendors/bundle.js"></script>

<!-- Chartjs -->
<script src="vendors/charts/chartjs/chart.min.js"></script>

<!-- Apex chart -->
<script src="vendors/charts/apex/apexcharts.min.js"></script>

<!-- Circle progress -->
<script src="vendors/circle-progress/circle-progress.min.js"></script>

<!-- Peity -->
<script src="vendors/charts/peity/jquery.peity.min.js"></script>
<script src="assets/js/examples/charts/peity.js"></script>

<!-- Datepicker -->
<script src="vendors/datepicker/daterangepicker.js"></script>

<!-- Slick -->
<script src="vendors/slick/slick.min.js"></script>

<!-- Vamp -->
<script src="vendors/vmap/jquery.vmap.min.js"></script>
<script src="vendors/vmap/maps/jquery.vmap.usa.js"></script>
<script src="assets/js/examples/vmap.js"></script>

<!-- Dashboard scripts -->
<script src="assets/js/examples/dashboard.js"></script>
<div class="colors"> <!-- To use theme colors with Javascript -->
    <div class="bg-primary"></div>
    <div class="bg-primary-bright"></div>
    <div class="bg-secondary"></div>
    <div class="bg-secondary-bright"></div>
    <div class="bg-info"></div>
    <div class="bg-info-bright"></div>
    <div class="bg-success"></div>
    <div class="bg-success-bright"></div>
    <div class="bg-danger"></div>
    <div class="bg-danger-bright"></div>
    <div class="bg-warning"></div>
    <div class="bg-warning-bright"></div>
</div>

<!-- App scripts -->
<script src="assets/js/app.min.js"></script>
</body>
</html>